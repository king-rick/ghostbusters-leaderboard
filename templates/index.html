<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Ghostbusters Pinball Leaderboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Ghostbusters-style fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Roboto+Condensed:wght@400;600&display=swap" rel="stylesheet">

    <style>
      /* ===== Ghostbusters Theme ===== */
      :root{
        --bg:#0b0f14;
        --panel:#101826;
        --border:#1e2a44;
        --text:#e8f0ff;
        --muted:#9fb0d2;
        --slime:#39ff14;
        --ghost-red:#e10600;
        --accent-blue:#00b7ff;
      }

      *{box-sizing:border-box}
      body{
        margin:0; padding:24px;
        background:
          radial-gradient(1200px 800px at 20% -10%, rgba(57,255,20,0.08), transparent 60%),
          radial-gradient(900px 600px at 110% 10%, rgba(0,183,255,0.10), transparent 60%),
          var(--bg);
        color:var(--text);
        font-family:'Roboto Condensed', system-ui, -apple-system, sans-serif;
        line-height:1.45;
        position:relative;
        overflow-x:hidden;
      }

      /* Pulsing Ghostbusters watermark */
      body::after{
        content:"";
        position:fixed;
        bottom:20px;
        right:20px;
        width:220px;
        height:220px;
        background:url('{{ url_for('static', filename='img/logo.png') }}') no-repeat center/contain;
        opacity:0.07;
        filter:drop-shadow(0 0 10px rgba(225,6,0,0.6));
        pointer-events:none;
        z-index:0;
        animation:pulseGlow 6s ease-in-out infinite;
        will-change:opacity,filter,transform;
      }

      @keyframes pulseGlow{
        0%   { opacity:0.06; filter:drop-shadow(0 0 8px rgba(225,6,0,0.4));  transform:scale(1); }
        50%  { opacity:0.12; filter:drop-shadow(0 0 18px rgba(225,6,0,0.9)); transform:scale(1.03); }
        100% { opacity:0.06; filter:drop-shadow(0 0 8px rgba(225,6,0,0.4));  transform:scale(1); }
      }

      h1,h2{
        font-family:'Bebas Neue', sans-serif;
        letter-spacing:0.5px;
        margin:0 0 14px 0;
        position:relative;
        z-index:2;
      }
      h1{
        font-size:48px;
        color:#fff;
        text-shadow:0 0 10px rgba(57,255,20,0.7);
      }
      h2{
        font-size:26px;
        color:var(--accent-blue);
        text-transform:uppercase;
      }

      .container{max-width:1100px; margin:0 auto; position:relative; z-index:1;}
      .muted{color:var(--muted); font-size:13px}

      /* Flash banners */
      ul.flash{list-style:none; margin:14px 0; padding:0}
      ul.flash li{
        margin:0 0 10px 0; padding:12px 16px;
        border:1px solid #2a4a2a;
        border-radius:12px;
        color:#082b08;
        font-weight:700; font-size:20px; text-align:center;
        background:
          linear-gradient(135deg, rgba(57,255,20,0.22), rgba(154,255,112,0.18)),
          radial-gradient(120% 220% at -10% -20%, rgba(57,255,20,0.45), transparent 40%),
          #d6ffd0;
        box-shadow:
          0 0 0 1px rgba(57,255,20,0.25) inset,
          0 8px 24px rgba(57,255,20,0.18);
        animation: pop .35s ease-out, fadeOut 0.3s ease-in 4.2s forwards;
      }
      ul.flash li.error{
        background:
          linear-gradient(135deg, rgba(225,6,0,0.22), rgba(225,6,0,0.12)),
          #ffd6d6;
        color:#3d0a0a;
        border-color:#6b1c1c;
        box-shadow:0 0 0 1px rgba(225,6,0,0.25) inset, 0 8px 24px rgba(225,6,0,0.2);
      }
      @keyframes pop{from{transform:translateY(-8px);opacity:0}to{transform:translateY(0);opacity:1}}
      @keyframes fadeOut{to{opacity:0;transform:translateY(-6px)}}

      /* Panels & layout */
      .panel{
        background:var(--panel);
        border:1px solid var(--border);
        border-radius:14px;
        padding:16px;
      }
      .cols{display:grid; grid-template-columns:1fr 1fr; gap:24px; margin-top:24px}
      @media(max-width:900px){.cols{grid-template-columns:1fr}}

      /* Form */
      form.box{max-width:520px}
      label span{display:block; font-size:12px; color:var(--muted); margin:0 0 6px}
      input{
        width:100%; color:var(--text); background:#0b1322;
        border:1px solid var(--border); border-radius:10px;
        padding:10px 12px; outline:none;
      }
      input:focus{
        border-color:var(--accent-blue);
        box-shadow:0 0 0 3px rgba(0,183,255,.15);
      }
      .btn{
        margin-top:10px; padding:10px 14px; border-radius:10px;
        border:1px solid var(--border); cursor:pointer;
        background:linear-gradient(180deg,#101b2f,#0e1526);
        color:#eaf2ff;
        font-family:'Bebas Neue',sans-serif;
        font-size:18px;
        letter-spacing:0.5px;
      }
      .btn:hover{filter:brightness(1.08)}
      .btn-danger{
        background:linear-gradient(180deg,#ff3b30,var(--ghost-red));
        border-color:#922;color:white;
      }

      /* Tables */
      table{width:100%;border-collapse:collapse;overflow:hidden;border-radius:12px;border:1px solid var(--border)}
      thead tr{background:rgba(0,183,255,0.10)}
      th,td{padding:10px 12px;border-bottom:1px solid var(--border)}
      th:last-child,td:last-child{text-align:right}
      .rank{width:70px}
      .score{text-align:right;white-space:nowrap}
      .toolbar{display:flex;gap:12px;align-items:center;margin:8px 0 14px}
      h2::after{
        content:"";display:block;height:3px;width:90px;margin-top:6px;
        background:linear-gradient(90deg,var(--slime),transparent);
        border-radius:2px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>üëª Ghostbusters Pinball Leaderboard</h1>

      <!-- Flash banners -->
      {% with msgs = get_flashed_messages(with_categories=true) %}
        {% if msgs %}
          <ul class="flash">
            {% for cat, msg in msgs %}
              <li class="{{ cat }}">{{ msg }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}

      <!-- Submit form -->
      <h2>Submit a Score</h2>
      <form class="panel box" action="{{ url_for('submit') }}" method="post">
        <p>
          <label>
            <span>Name</span>
            <input name="name" required placeholder="e.g., Rick" autocomplete="name">
          </label>
        </p>
        <p>
          <label>
            <span>Score</span>
            <input name="score" required inputmode="numeric" placeholder="e.g., 1,234,567">
          </label>
        </p>
        <button type="submit" class="btn">Add Score</button>
      </form>

      <div class="cols">
        <!-- Leaderboard -->
        <section class="panel">
          <h2>üèÜ Leaderboard (Top 10)</h2>
          <div class="toolbar">
            <form action="{{ url_for('clear') }}" method="post">
              <button type="submit" class="btn btn-danger">üö® Clear Leaderboard</button>
            </form>
          </div>

          {% if leaderboard %}
            <table>
              <thead>
                <tr>
                  <th class="rank">Rank</th>
                  <th>Player</th>
                  <th class="score">Best Score</th>
                  <th>Date</th>
                </tr>
              </thead>
              <tbody>
                {% for row in leaderboard %}
                  <tr>
                    <td class="rank">
                      {% if loop.index == 1 %}üèÜ 1
                      {% elif loop.index == 2 %}ü•à 2
                      {% elif loop.index == 3 %}ü•â 3
                      {% else %}{{ loop.index }}
                      {% endif %}
                    </td>
                    <td>{{ row['name'] }}</td>
                    <td class="score">{{ "{:,}".format(row['score']) }}</td>
                    <td>{{ row['created_at'][:10] }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          {% else %}
            <p class="muted">No scores yet ‚Äî add one above.</p>
          {% endif %}
        </section>

        <!-- Recent submissions -->
        <section class="panel">
          <h2>üïí Recent Submissions</h2>
          {% if recent %}
            <ul>
              {% for row in recent %}
                <li>
                  <strong>{{ row['name'] }}</strong>
                  scored {{ "{:,}".format(row['score']) }}
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="muted">Nothing recent yet.</p>
          {% endif %}
        </section>
      </div>
    </div>
  </body>
</html>